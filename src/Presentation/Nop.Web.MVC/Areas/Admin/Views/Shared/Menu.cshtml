@using Telerik.Web.Mvc.UI;
@{
    Telerik.Web.Mvc.SiteMapManager.SiteMaps.Remove("admin");
    if (!Telerik.Web.Mvc.SiteMapManager.SiteMaps.ContainsKey("admin"))
    {
        Telerik.Web.Mvc.SiteMapManager.SiteMaps.Register<Telerik.Web.Mvc.XmlSiteMap>("admin", sitmap =>
            sitmap.LoadFrom("~/Areas/Admin/sitemap.xml"));
    }
    var adminMenuPlugins = EngineContext.Current.Resolve<Nop.Core.Plugins.IPluginFinder>().GetPlugins<Nop.Core.Web.IAdminMenuPlugin>();
}
@{
    Html.Telerik().Menu().Name("Admin")
    .BindTo("admin", (item, siteMapNode) =>
    {
        //item.Text = T(item.Text).Text;
    })
    .Items(x =>
    {
        if (adminMenuPlugins.Count() > 0)
        {
            x.Add().Text("Plugins").Items(y =>
            {
                foreach (var adminMenuPlugin in adminMenuPlugins)
                {
                    adminMenuPlugin.BuildMenuItem(y.Add());
                }
            });
        }
    })
    .OpenOnClick(true)
    
    .Render();
}
